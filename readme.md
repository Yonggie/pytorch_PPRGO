# The Unofficial Pytorch implementation of PPRGO
Pytorch implementation of PPRGO in paper "Is PageRank All You Need for Scalable Graph Neural Networks?"

The main example is in ``dgl_pprgo.py``, the rest are pretty much useless.

## Setup environment
```
conda env create -f env.yaml
```

## Dataset
Dataset yelp from [DGL datasets](https://docs.dgl.ai/api/python/dgl.data.html) from finacial fraud detection.

## Run
```
python dgl_pprgo.py
```

## Note 
As personalized page rank is very time-comsuming, you may take a long time to convey the first run.

## Example training log
```
start training...
load PPR information from the existing.
epoch 0, loss 3.583087205886841, acc 0.024809575625680088
epoch 10, loss 3.1935362815856934, acc 0.026985854189336234
epoch 20, loss 2.877210855484009, acc 0.5891186071817193
epoch 30, loss 2.637073516845703, acc 0.5912948857453754
epoch 40, loss 2.451789379119873, acc 0.5934711643090316
epoch 50, loss 2.3082985877990723, acc 0.7331882480957562
epoch 60, loss 2.194859027862549, acc 0.7347116430903156
epoch 70, loss 2.102661371231079, acc 0.7351468988030468
epoch 80, loss 2.025949001312256, acc 0.7366702937976061
epoch 90, loss 1.960776448249817, acc 0.7499455930359086
epoch 100, loss 1.9043818712234497, acc 0.7503808487486399
epoch 110, loss 1.8548282384872437, acc 0.750816104461371
epoch 120, loss 1.8107314109802246, acc 0.7623503808487486
epoch 130, loss 1.7710742950439453, acc 0.7625680087051142
epoch 140, loss 1.735095500946045, acc 0.7710554951033732
epoch 150, loss 1.7022138833999634, acc 0.7712731229597388
epoch 160, loss 1.6719779968261719, acc 0.7714907508161044
epoch 170, loss 1.6440308094024658, acc 0.7717083786724701
epoch 180, loss 1.61808443069458, acc 0.7727965179542982
epoch 190, loss 1.5939033031463623, acc 0.7732317736670293
epoch 200, loss 1.5712906122207642, acc 0.773449401523395
epoch 210, loss 1.5500805377960205, acc 0.7736670293797606
epoch 220, loss 1.530131220817566, acc 0.7738846572361262
epoch 230, loss 1.5113192796707153, acc 0.7738846572361262
epoch 240, loss 1.4935382604599, acc 0.7693144722524483
epoch 250, loss 1.4766948223114014, acc 0.7697497279651796
epoch 260, loss 1.4607062339782715, acc 0.7699673558215452
epoch 270, loss 1.4454997777938843, acc 0.7690968443960827
epoch 280, loss 1.4310109615325928, acc 0.7693144722524483
epoch 290, loss 1.4171817302703857, acc 0.7693144722524483
epoch 300, loss 1.4039610624313354, acc 0.7699673558215452
epoch 310, loss 1.3913023471832275, acc 0.7704026115342764
epoch 320, loss 1.3791640996932983, acc 0.7704026115342764
epoch 330, loss 1.367508888244629, acc 0.7697497279651796
epoch 340, loss 1.3563032150268555, acc 0.7699673558215452
epoch 350, loss 1.3455159664154053, acc 0.7701849836779108
epoch 360, loss 1.3351188898086548, acc 0.7701849836779108
epoch 370, loss 1.3250874280929565, acc 0.7699673558215452
epoch 380, loss 1.3153977394104004, acc 0.7701849836779108
epoch 390, loss 1.3060293197631836, acc 0.7701849836779108
epoch 400, loss 1.2969624996185303, acc 0.7743199129488575
epoch 410, loss 1.2881793975830078, acc 0.7738846572361262
epoch 420, loss 1.279664397239685, acc 0.7738846572361262
epoch 430, loss 1.2714016437530518, acc 0.7738846572361262
epoch 440, loss 1.2633779048919678, acc 0.7817192600652884
epoch 450, loss 1.2555803060531616, acc 0.7821545157780195
epoch 460, loss 1.2479974031448364, acc 0.783025027203482
epoch 470, loss 1.2406176328659058, acc 0.783025027203482
epoch 480, loss 1.2334319353103638, acc 0.783025027203482
epoch 490, loss 1.2264304161071777, acc 0.783025027203482
epoch 500, loss 1.2196043729782104, acc 0.7825897714907508
epoch 510, loss 1.2129465341567993, acc 0.7825897714907508
epoch 520, loss 1.2064489126205444, acc 0.7854189336235038
epoch 530, loss 1.20010507106781, acc 0.7854189336235038
epoch 540, loss 1.1939083337783813, acc 0.7854189336235038
epoch 550, loss 1.187853217124939, acc 0.7858541893362351
epoch 560, loss 1.1819343566894531, acc 0.7858541893362351
epoch 570, loss 1.1761462688446045, acc 0.7852013057671382
epoch 580, loss 1.1704846620559692, acc 0.7910772578890098
epoch 590, loss 1.1649450063705444, acc 0.7956474428726877
epoch 600, loss 1.1595232486724854, acc 0.7958650707290533
epoch 610, loss 1.1542155742645264, acc 0.7956474428726877
epoch 620, loss 1.1490182876586914, acc 0.795429815016322
epoch 630, loss 1.1439279317855835, acc 0.7958650707290533
epoch 640, loss 1.1389414072036743, acc 0.8004352557127312
epoch 650, loss 1.1340551376342773, acc 0.8008705114254625
epoch 660, loss 1.1292662620544434, acc 0.8006528835690968
epoch 670, loss 1.1245718002319336, acc 0.7997823721436343
epoch 680, loss 1.1199687719345093, acc 0.7995647442872688
epoch 690, loss 1.1154544353485107, acc 0.7995647442872688
epoch 700, loss 1.1110260486602783, acc 0.7995647442872688
epoch 710, loss 1.1066811084747314, acc 0.7997823721436343
epoch 720, loss 1.1024168729782104, acc 0.7997823721436343
epoch 730, loss 1.098231315612793, acc 0.7997823721436343
epoch 740, loss 1.094122052192688, acc 0.7997823721436343
epoch 750, loss 1.090086817741394, acc 0.7997823721436343
epoch 760, loss 1.0861238241195679, acc 0.8002176278563656
epoch 770, loss 1.082230567932129, acc 0.8006528835690968
epoch 780, loss 1.0784052610397339, acc 0.8006528835690968
epoch 790, loss 1.0746464729309082, acc 0.8006528835690968
epoch 800, loss 1.0709518194198608, acc 0.8006528835690968
epoch 810, loss 1.0673202276229858, acc 0.8008705114254625
epoch 820, loss 1.0637495517730713, acc 0.8015233949945593
epoch 830, loss 1.0602384805679321, acc 0.8015233949945593
epoch 840, loss 1.0567855834960938, acc 0.8015233949945593
epoch 850, loss 1.0533889532089233, acc 0.8015233949945593
epoch 860, loss 1.0500476360321045, acc 0.8015233949945593
epoch 870, loss 1.0467599630355835, acc 0.8015233949945593
epoch 880, loss 1.0435248613357544, acc 0.8013057671381937
epoch 890, loss 1.040340781211853, acc 0.8013057671381937
epoch 900, loss 1.0372062921524048, acc 0.8015233949945593
epoch 910, loss 1.0341209173202515, acc 0.8015233949945593
epoch 920, loss 1.0310825109481812, acc 0.8019586507072906
epoch 930, loss 1.0280909538269043, acc 0.8023939064200217
epoch 940, loss 1.0251439809799194, acc 0.8026115342763874
epoch 950, loss 1.0222415924072266, acc 0.8026115342763874
epoch 960, loss 1.0193818807601929, acc 0.8026115342763874
epoch 970, loss 1.0165646076202393, acc 0.8026115342763874
epoch 980, loss 1.013788104057312, acc 0.8043525571273124
epoch 990, loss 1.011051893234253, acc 0.8043525571273124
testing...
final test: 0.8035248041775457, std 0.0
```